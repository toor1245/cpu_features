<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>cpu_features | cpu features</title><meta name="description" content="A cross platform C99 library to get cpu features at runtime"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.21">
    <link rel="preload" href="/cpu_features/assets/js/runtime~app.a90dfb4d.js" as="script"><link rel="preload" href="/cpu_features/assets/css/styles.2ee025ee.css" as="style"><link rel="preload" href="/cpu_features/assets/js/640.dec258aa.js" as="script"><link rel="preload" href="/cpu_features/assets/js/app.42a0f076.js" as="script">
    <link rel="stylesheet" href="/cpu_features/assets/css/styles.2ee025ee.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/cpu_features/" class=""><img class="logo" src="https://vuejs.org/images/logo.png" alt="cpu features"><span class="site-name can-hide">cpu features</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/cpu_features/README.md" class="nav-link" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/cpu_features/guide/getting_started.md" class="nav-link" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/cpu_features/CONTRIBUTING.md" class="nav-link" aria-label="Contributing"><!--[--><!--]--> Contributing <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/cpu_features/README.md" class="nav-link" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/cpu_features/guide/getting_started.md" class="nav-link" aria-label="Guide"><!--[--><!--]--> Guide <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/cpu_features/CONTRIBUTING.md" class="nav-link" aria-label="Contributing"><!--[--><!--]--> Contributing <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">cpu_features</p><ul class=""><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#design-rationale" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Design Rationale"><!--[--><!--]--> Design Rationale <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#code-samples" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Code samples"><!--[--><!--]--> Code samples <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#checking-features-at-runtime" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Checking features at runtime"><!--[--><!--]--> Checking features at runtime <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#caching-for-faster-evaluation-of-complex-checks" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Caching for faster evaluation of complex checks"><!--[--><!--]--> Caching for faster evaluation of complex checks <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#checking-compile-time-flags" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Checking compile time flags"><!--[--><!--]--> Checking compile time flags <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#rejecting-poor-hardware-implementations-based-on-microarchitecture" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Rejecting poor hardware implementations based on microarchitecture"><!--[--><!--]--> Rejecting poor hardware implementations based on microarchitecture <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#running-sample-code" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Running sample code"><!--[--><!--]--> Running sample code <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#what-s-supported" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="What&#39;s supported"><!--[--><!--]--> What&#39;s supported <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#android-ndk-s-drop-in-replacement" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Android NDK&#39;s drop in replacement"><!--[--><!--]--> Android NDK&#39;s drop in replacement <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#license" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="License"><!--[--><!--]--> License <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#build-with-cmake" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Build with CMake"><!--[--><!--]--> Build with CMake <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/cpu_features/guide/getting_started.html#quickstart-with-ninja" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Quickstart with Ninja"><!--[--><!--]--> Quickstart with Ninja <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="cpu-features" tabindex="-1"><a class="header-anchor" href="#cpu-features" aria-hidden="true">#</a> cpu_features <a href="https://travis-ci.org/google/cpu_features" target="_blank" rel="noopener noreferrer"><img src="https://travis-ci.org/google/cpu_features.svg?branch=master" alt="Build Status"><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> <a href="https://ci.appveyor.com/project/gchatelet/cpu-features/branch/master" target="_blank" rel="noopener noreferrer"><img src="https://ci.appveyor.com/api/projects/status/46d1owsj7n8dsylq/branch/master?svg=true" alt="Build status"><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></h1><p>A cross-platform C library to retrieve CPU features (such as available instructions) at runtime.</p><ul><li><a href="#rationale">Design Rationale</a></li><li><a href="#codesample">Code samples</a></li><li><a href="#usagesample">Running sample code</a></li><li><a href="#support">What&#39;s supported</a></li><li><a href="#ndk">Android NDK&#39;s drop in replacement</a></li><li><a href="#license">License</a></li><li><a href="#cmake">Build with cmake</a></li></ul><p><a name="rationale"></a></p><h2 id="design-rationale" tabindex="-1"><a class="header-anchor" href="#design-rationale" aria-hidden="true">#</a> Design Rationale</h2><ul><li><strong>Simple to use.</strong> See the snippets below for examples.</li><li><strong>Extensible.</strong> Easy to add missing features or architectures.</li><li><strong>Compatible with old compilers</strong> and available on many architectures so it can be used widely. To ensure that cpu_features works on as many platforms as possible, we implemented it in a highly portable version of C: C99.</li><li><strong>Sandbox-compatible.</strong> The library uses a variety of strategies to cope with sandboxed environments or when <code>cpuid</code> is unavailable. This is useful when running integration tests in hermetic environments.</li><li><strong>Thread safe, no memory allocation, and raises no exceptions.</strong> cpu_features is suitable for implementing fundamental libc functions like <code>malloc</code>, <code>memcpy</code>, and <code>memcmp</code>.</li><li><strong>Unit tested.</strong></li></ul><p><a name="codesample"></a></p><h2 id="code-samples" tabindex="-1"><a class="header-anchor" href="#code-samples" aria-hidden="true">#</a> Code samples</h2><p><strong>Note:</strong> For C++ code, the library functions are defined in the <code>cpu_features</code> namespace.</p><h3 id="checking-features-at-runtime" tabindex="-1"><a class="header-anchor" href="#checking-features-at-runtime" aria-hidden="true">#</a> Checking features at runtime</h3><p>Here&#39;s a simple example that executes a codepath if the CPU supports both the AES and the SSE4.2 instruction sets:</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;cpuinfo_x86.h&quot;</span></span>

<span class="token comment">// For C++, add `using namespace cpu_features;`</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> X86Features features <span class="token operator">=</span> <span class="token function">GetX86Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>features<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">Compute</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>features<span class="token punctuation">.</span>aes <span class="token operator">&amp;&amp;</span> features<span class="token punctuation">.</span>sse4_2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Run optimized code.</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token comment">// Run standard code.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="caching-for-faster-evaluation-of-complex-checks" tabindex="-1"><a class="header-anchor" href="#caching-for-faster-evaluation-of-complex-checks" aria-hidden="true">#</a> Caching for faster evaluation of complex checks</h3><p>If you wish, you can read all the features at once into a global variable, and then query for the specific features you care about. Below, we store all the ARM features and then check whether AES and NEON are supported.</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;cpuinfo_arm.h&quot;</span></span>

<span class="token comment">// For C++, add `using namespace cpu_features;`</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> ArmFeatures features <span class="token operator">=</span> <span class="token function">GetArmInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>features<span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> bool has_aes_and_neon <span class="token operator">=</span> features<span class="token punctuation">.</span>aes <span class="token operator">&amp;&amp;</span> features<span class="token punctuation">.</span>neon<span class="token punctuation">;</span>

<span class="token comment">// use has_aes_and_neon.</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>This is a good approach to take if you&#39;re checking for combinations of features when using a compiler that is slow to extract individual bits from bit-packed structures.</p><h3 id="checking-compile-time-flags" tabindex="-1"><a class="header-anchor" href="#checking-compile-time-flags" aria-hidden="true">#</a> Checking compile time flags</h3><p>The following code determines whether the compiler was told to use the AVX instruction set (e.g., <code>g++ -mavx</code>) and sets <code>has_avx</code> accordingly.</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;cpuinfo_x86.h&quot;</span></span>

<span class="token comment">// For C++, add `using namespace cpu_features;`</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> X86Features features <span class="token operator">=</span> <span class="token function">GetX86Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>features<span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> bool has_avx <span class="token operator">=</span> CPU_FEATURES_COMPILED_X86_AVX <span class="token operator">||</span> features<span class="token punctuation">.</span>avx<span class="token punctuation">;</span>

<span class="token comment">// use has_avx.</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><code>CPU_FEATURES_COMPILED_X86_AVX</code> is set to 1 if the compiler was instructed to use AVX and 0 otherwise, combining compile time and runtime knowledge.</p><h3 id="rejecting-poor-hardware-implementations-based-on-microarchitecture" tabindex="-1"><a class="header-anchor" href="#rejecting-poor-hardware-implementations-based-on-microarchitecture" aria-hidden="true">#</a> Rejecting poor hardware implementations based on microarchitecture</h3><p>On x86, the first incarnation of a feature in a microarchitecture might not be the most efficient (e.g. AVX on Sandy Bridge). We provide a function to retrieve the underlying microarchitecture so you can decide whether to use it.</p><p>Below, <code>has_fast_avx</code> is set to 1 if the CPU supports the AVX instruction set—but only if it&#39;s not Sandy Bridge.</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdbool.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;cpuinfo_x86.h&quot;</span></span>

<span class="token comment">// For C++, add `using namespace cpu_features;`</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> X86Info info <span class="token operator">=</span> <span class="token function">GetX86Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> X86Microarchitecture uarch <span class="token operator">=</span> <span class="token function">GetX86Microarchitecture</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> bool has_fast_avx <span class="token operator">=</span> info<span class="token punctuation">.</span>features<span class="token punctuation">.</span>avx <span class="token operator">&amp;&amp;</span> uarch <span class="token operator">!=</span> INTEL_SNB<span class="token punctuation">;</span>

<span class="token comment">// use has_fast_avx.</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>This feature is currently available only for x86 microarchitectures.</p><p><a name="usagesample"></a></p><h3 id="running-sample-code" tabindex="-1"><a class="header-anchor" href="#running-sample-code" aria-hidden="true">#</a> Running sample code</h3><p>Building <code>cpu_features</code> (check <a href="#quickstart">quickstart</a> below) brings a small executable to test the library.</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code> % ./build/list_cpu_features
arch            <span class="token builtin class-name">:</span> x86
brand           <span class="token builtin class-name">:</span>        Intel<span class="token punctuation">(</span>R<span class="token punctuation">)</span> Xeon<span class="token punctuation">(</span>R<span class="token punctuation">)</span> CPU E5-1650 <span class="token number">0</span> @ <span class="token number">3</span>.20GHz
family          <span class="token builtin class-name">:</span>   <span class="token number">6</span> <span class="token punctuation">(</span>0x06<span class="token punctuation">)</span>
model           <span class="token builtin class-name">:</span>  <span class="token number">45</span> <span class="token punctuation">(</span>0x2D<span class="token punctuation">)</span>
stepping        <span class="token builtin class-name">:</span>   <span class="token number">7</span> <span class="token punctuation">(</span>0x07<span class="token punctuation">)</span>
uarch           <span class="token builtin class-name">:</span> INTEL_SNB
flags           <span class="token builtin class-name">:</span> aes,avx,cx16,smx,sse4_1,sse4_2,ssse3
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>% ./build/list_cpu_features --json
<span class="token punctuation">{</span><span class="token string">&quot;arch&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;x86&quot;</span>,<span class="token string">&quot;brand&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;       Intel(R) Xeon(R) CPU E5-1650 0 @ 3.20GHz&quot;</span>,<span class="token string">&quot;family&quot;</span>:6,<span class="token string">&quot;model&quot;</span>:45,<span class="token string">&quot;stepping&quot;</span>:7,<span class="token string">&quot;uarch&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;INTEL_SNB&quot;</span>,<span class="token string">&quot;flags&quot;</span>:<span class="token punctuation">[</span><span class="token string">&quot;aes&quot;</span>,<span class="token string">&quot;avx&quot;</span>,<span class="token string">&quot;cx16&quot;</span>,<span class="token string">&quot;smx&quot;</span>,<span class="token string">&quot;sse4_1&quot;</span>,<span class="token string">&quot;sse4_2&quot;</span>,<span class="token string">&quot;ssse3&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><a name="support"></a></p><h2 id="what-s-supported" tabindex="-1"><a class="header-anchor" href="#what-s-supported" aria-hidden="true">#</a> What&#39;s supported</h2><table><thead><tr><th></th><th style="text-align:center;">x86³</th><th style="text-align:center;">ARM</th><th style="text-align:center;">AArch64</th><th style="text-align:center;">MIPS⁴</th><th style="text-align:center;">POWER</th></tr></thead><tbody><tr><td>Android</td><td style="text-align:center;">yes²</td><td style="text-align:center;">yes¹</td><td style="text-align:center;">yes¹</td><td style="text-align:center;">yes¹</td><td style="text-align:center;">N/A</td></tr><tr><td>iOS</td><td style="text-align:center;">N/A</td><td style="text-align:center;">not yet</td><td style="text-align:center;">not yet</td><td style="text-align:center;">N/A</td><td style="text-align:center;">N/A</td></tr><tr><td>Linux</td><td style="text-align:center;">yes²</td><td style="text-align:center;">yes¹</td><td style="text-align:center;">yes¹</td><td style="text-align:center;">yes¹</td><td style="text-align:center;">yes¹</td></tr><tr><td>MacOs</td><td style="text-align:center;">yes²</td><td style="text-align:center;">N/A</td><td style="text-align:center;">not yet</td><td style="text-align:center;">N/A</td><td style="text-align:center;">no</td></tr><tr><td>Windows</td><td style="text-align:center;">yes²</td><td style="text-align:center;">not yet</td><td style="text-align:center;">not yet</td><td style="text-align:center;">N/A</td><td style="text-align:center;">N/A</td></tr><tr><td>FreeBSD</td><td style="text-align:center;">yes²</td><td style="text-align:center;">not yet</td><td style="text-align:center;">not yet</td><td style="text-align:center;">not yet</td><td style="text-align:center;">not yet</td></tr></tbody></table><ol><li><strong>Features revealed from Linux.</strong> We gather data from several sources depending on availability: <ul><li>from glibc&#39;s <a href="https://www.gnu.org/software/libc/manual/html_node/Auxiliary-Vector.html" target="_blank" rel="noopener noreferrer">getauxval<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li><li>by parsing <code>/proc/self/auxv</code></li><li>by parsing <code>/proc/cpuinfo</code></li></ul></li><li><strong>Features revealed from CPU.</strong> features are retrieved by using the <code>cpuid</code> instruction.</li><li><strong>Microarchitecture detection.</strong> On x86 some features are not always implemented efficiently in hardware (e.g. AVX on Sandybridge). Exposing the microarchitecture allows the client to reject particular microarchitectures.</li><li>All flavors of Mips are supported, little and big endian as well as 32/64 bits.</li></ol><p><a name="ndk"></a></p><h2 id="android-ndk-s-drop-in-replacement" tabindex="-1"><a class="header-anchor" href="#android-ndk-s-drop-in-replacement" aria-hidden="true">#</a> Android NDK&#39;s drop in replacement</h2><p><a href="https://github.com/google/cpu_features" target="_blank" rel="noopener noreferrer">cpu_features<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> is now officially supporting Android and offers a drop in replacement of for the NDK&#39;s <a href="https://android.googlesource.com/platform/ndk/+/master/sources/android/cpufeatures/cpu-features.h" target="_blank" rel="noopener noreferrer">cpu-features.h<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> , see <a href="ndk_compat">ndk_compat</a> folder for details.</p><p><a name="license"></a></p><h2 id="license" tabindex="-1"><a class="header-anchor" href="#license" aria-hidden="true">#</a> License</h2><p>The cpu_features library is licensed under the terms of the Apache license. See <a href="LICENSE">LICENSE</a> for more information.</p><p><a name="cmake"></a></p><h2 id="build-with-cmake" tabindex="-1"><a class="header-anchor" href="#build-with-cmake" aria-hidden="true">#</a> Build with CMake</h2><p>Please check the <a href="/cpu_features/guide/cmake/" class="">CMake build instructions</a>.</p><p><a name="quickstart"></a></p><h3 id="quickstart-with-ninja" tabindex="-1"><a class="header-anchor" href="#quickstart-with-ninja" aria-hidden="true">#</a> Quickstart with <code>Ninja</code></h3><ul><li>build <code>list_cpu_features</code></li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>    cmake -B/tmp/cpu_features -H. -GNinja -DCMAKE_BUILD_TYPE=Release
    ninja -C/tmp/cpu_features
    /tmp/cpu_features/list_cpu_features --json
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>run tests</li></ul><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>    cmake -B/tmp/cpu_features -H. -GNinja -DBUILD_TESTING=ON
    ninja -C/tmp/cpu_features
    ninja -C/tmp/cpu_features test
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">7/7/2021, 10:50:16 PM</span></div><!----></footer><!----><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/cpu_features/assets/js/runtime~app.a90dfb4d.js" defer></script><script src="/cpu_features/assets/js/640.dec258aa.js" defer></script><script src="/cpu_features/assets/js/app.42a0f076.js" defer></script>
  </body>
</html>
